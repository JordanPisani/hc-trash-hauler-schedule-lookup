import{C as i,E as o,j as B,ap as u,m as A,v as N,aq as b,G as O,T as C,ar as F,h as x,r as E,as as I,at as J,_ as T}from"./index.4a406848.js";import{a as q,i as c,u as V,f as k,d as D,o as G}from"./NAMessage.cc446b7b.js";import{v as K}from"./normalizeUtils.0579d35f.js";import{c as M}from"./DirectionsFeatureSet.2b9eee2a.js";import"./GPMessage.c3ed940a.js";var Q=Object.defineProperty,W=Object.defineProperties,Z=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,h=(e,r,s)=>r in e?Q(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,v=(e,r)=>{for(var s in r||(r={}))z.call(r,s)&&h(e,s,r[s]);if($)for(var s of $(r))H.call(r,s)&&h(e,s,r[s]);return e},_=(e,r)=>W(e,Z(r));function L(e){return e.features.map(r=>{const s=x.fromJSON(e.spatialReference),n=b.fromJSON(r);return E(n.geometry)&&(n.geometry.spatialReference=s),n})}function f(e){return F.fromJSON(e).features.map(r=>r.geometry)}let t=class extends C{constructor(e){super(e),this.directions=null,this.facilities=null,this.incidents=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routes=null}readFacilities(e){return f(e)}readIncidents(e){return f(e)}readPointBarriers(e,r){return f(r.barriers)}readPolylineBarriers(e){return f(e)}readPolygonBarriers(e){return f(e)}readRoutes(e){return L(e)}};i([o({type:[M]})],t.prototype,"directions",void 0),i([o({type:[B]})],t.prototype,"facilities",void 0),i([u("facilities")],t.prototype,"readFacilities",null),i([o({type:[B]})],t.prototype,"incidents",void 0),i([u("incidents")],t.prototype,"readIncidents",null),i([o({type:[q]})],t.prototype,"messages",void 0),i([o({type:[B]})],t.prototype,"pointBarriers",void 0),i([u("pointBarriers",["barriers"])],t.prototype,"readPointBarriers",null),i([o({type:[A]})],t.prototype,"polylineBarriers",void 0),i([u("polylineBarriers")],t.prototype,"readPolylineBarriers",null),i([o({type:[N]})],t.prototype,"polygonBarriers",void 0),i([u("polygonBarriers")],t.prototype,"readPolygonBarriers",null),i([o({type:[b]})],t.prototype,"routes",void 0),i([u("routes")],t.prototype,"readRoutes",null),t=i([O("esri.rest.support.ClosestFacilitySolveResult")],t);const U=t,X=G({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},facilities:!0,incidents:!0,outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},returnRoutes:{name:"returnCFRoutes"},travelMode:!0});async function Y(e,r,s){const n=[],p=[],l={},y={},g=J(e),{path:P}=g;r.incidents&&r.incidents.features&&c(r.incidents.features,p,"incidents.features",l),r.facilities&&r.facilities.features&&c(r.facilities.features,p,"facilities.features",l),r.pointBarriers&&r.pointBarriers.features&&c(r.pointBarriers.features,p,"pointBarriers.features",l),r.polylineBarriers&&r.polylineBarriers.features&&c(r.polylineBarriers.features,p,"polylineBarriers.features",l),r.polygonBarriers&&r.polygonBarriers.features&&c(r.polygonBarriers.features,p,"polygonBarriers.features",l);const w=await K(p);for(const a in l){const d=l[a];n.push(a),y[a]=w.slice(d[0],d[1])}if(V(y,n)){let a=null;try{a=await k(P,r.apiKey,s)}catch{}a&&!a.hasZ&&D(y,n)}for(const a in y)y[a].forEach((d,j)=>{r.get(a)[j].geometry=d});const R=_(v({},s),{query:_(v(v({},g.query),X.toQueryParams(r)),{f:"json"})}),{data:S}=await T(`${P}/solveClosestFacility`,R);return U.fromJSON(S)}let m=class extends I{constructor(e){super(e),this.url=null}solve(e,r){return Y(this.url,e,r)}};i([o()],m.prototype,"url",void 0),m=i([O("esri.tasks.ClosestFacilityTask")],m);const ar=m;export{ar as default};
