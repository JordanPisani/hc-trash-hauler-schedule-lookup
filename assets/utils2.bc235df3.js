import{C as R,E as $,G as K,av as nt,ap as it,ai as at,M as H,t as z,r as C,H as J,j as _,T as Ot,u as $t,h as Nt}from"./index.648f63f9.js";import{J as Mt,Q as kt,Y as W,o as jt,i as T,E,b as lt,c as zt,S as It}from"./projection.d97f7bcf.js";var Wt=Object.defineProperty,Yt=Object.defineProperties,Xt=Object.getOwnPropertyDescriptors,ft=Object.getOwnPropertySymbols,Ft=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable,ct=(t,e,r)=>e in t?Wt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ut=(t,e)=>{for(var r in e||(e={}))Ft.call(e,r)&&ct(t,r,e[r]);if(ft)for(var r of ft(e))At.call(e,r)&&ct(t,r,e[r]);return t},pt=(t,e)=>Yt(t,Xt(e));function Pt(t,e,r){return!jt(t,e,r)}function Y(t,e,r){const o=Pt(t,e,r);if(o&&!Mt())throw new $t("rasterprojectionhelper-project","projection engine is not loaded");return o}const mt=function(t,e,r,o=0){if(r[0]===1)return[0,0];let s=1,n=-1,a=1,l=-1;for(let f=0;f<t.length;f+=2)isNaN(t[f])||(s=s>t[f]?t[f]:s,n=n>t[f]?n:t[f],a=a>t[f+1]?t[f+1]:a,l=l>t[f+1]?l:t[f+1]);const{cols:i,rows:c}=e,p=(n-s)/i/r[0],d=(l-a)/c/r[1],h=2*o;let g=0,u=!1,x=[0,0];for(let f=0;f<i-3;f++){for(let w=0;w<c-3;w++){const m=f*c*2+2*w,y=(t[m]+t[m+4]+t[m+4*c]+t[m+4*c+4])/4,v=(t[m+1]+t[m+5]+t[m+4*c+1]+t[m+4*c+5])/4,M=Math.abs((y-t[m+2*c+2])/p),P=Math.abs((v-t[m+2*c+3])/d);if(M+P>g&&(g=M+P,x=[M,P]),h&&g>h){u=!0;break}}if(u)break}return x},Bt={3395:20037508342789244e-9,3410:17334193943686873e-9,3857:20037508342788905e-9,3975:17367530445161372e-9,4087:20037508342789244e-9,4088:20015108787169147e-9,6933:17367530445161372e-9,32662:20037508342789244e-9,53001:2001508679602057e-8,53002:1000754339801029e-8,53003:2001508679602057e-8,53004:2001508679602057e-8,53016:14152803599503474e-9,53017:17333573624304302e-9,53034:2001508679602057e-8,53079:20015114352186374e-9,53080:20015114352186374e-9,54001:20037508342789244e-9,54002:10018754171394624e-9,54003:20037508342789244e-9,54004:20037508342789244e-9,54016:14168658027268292e-9,54017:1736753044516137e-8,54034:20037508342789244e-9,54079:20037508342789244e-9,54080:20037508342789244e-9,54100:20037508342789244e-9,54101:20037508342789244e-9},L=32,q=4,V=q,U=new Map,Z=new Map;async function oe(){if(Mt())return null;await kt()}function se(t,e,r,o=null){const s=t.spatialReference;if(s.equals(e))return t;Y(s,e,o);const n=r.center,a=new H({xmin:n.x-t.x/2,xmax:n.x+t.x/2,ymin:n.y-t.y/2,ymax:n.y+t.y/2,spatialReference:s}),l=W(a,e,o);if(z(l))return null;const i={x:l.xmax-l.xmin,y:l.ymax-l.ymin},c=O(e);if(C(c)&&i.x>=c){const p=J(s)/J(e);i.x=t.x*p,i.y=t.y*p}return i}function G(t,e=.01){return J(t)?e/J(t):0}function xt(t,e,r=null,o=!0){const s=t.spatialReference;if(s.equals(e))return t;Y(s,e,r);const n=W(t,e,r);if(!o||!n)return n;const a=D(s,!0),l=D(e,!0),i=G(s);return i&&C(a)&&C(l)&&(n.x>0&&Math.abs(t.x-a[0])<i?n.x-=l[1]-l[0]:n.x<0&&Math.abs(t.x-a[1])<i&&(n.x+=l[1]-l[0])),n}function Jt(t){const{inSR:e,outSR:r,datumTransformation:o,preferPE:s}=t;if(e.equals(r)){const{points:n}=rt(t,null);return n}if(e.isWebMercator&&r.isWGS84||e.isWGS84&&r.isWebMercator)return qt(t);if(Y(e,r,o)&&s){if(e.isGeographic)return ht(t);const n=I(e);if(C(n))return ht(t)}return Lt(t)}function Lt(t){const{points:e}=rt(t,null),r=e.map(o=>new _(o[0],o[1],t.inSR));return W(r,t.outSR,t.datumTransformation).map(o=>o?[o.x,o.y]:[NaN,NaN])}function ht(t){const{inSR:e,outSR:r,datumTransformation:o}=t,s=I(e),{points:n,mask:a}=rt(t,s);if(!e.isGeographic){const i=e.wkid?T.coordsys(e.wkid):T.fromString(e.isGeographic?E.PE_TYPE_GEOGCS:E.PE_TYPE_PROJCS,e.wkt);lt.projToGeog(i,n.length,n)}if(C(o)&&o.steps.length&&o.steps.forEach(i=>{const c=i.wkid?T.geogtran(i.wkid):T.fromString(E.PE_TYPE_GEOGTRAN,i.wkt);zt.geogToGeog(c,n.length,n,null,i.isInverse?E.PE_TRANSFORM_2_TO_1:E.PE_TRANSFORM_1_TO_2)}),!r.isGeographic){const i=I(r,!0),c=C(i)&&i.isEnvelope?[i.bbox[1],i.bbox[3]]:[-90,90];Dt(n,c);const p=r.wkid?T.coordsys(r.wkid):T.fromString(r.isGeographic?E.PE_TYPE_GEOGCS:E.PE_TYPE_PROJCS,r.wkt);lt.geogToProj(p,n.length,n)}let l=n;if(a&&n.length!==a.length){l=[];for(let i=0,c=0;i<a.length;i++)a[i]?l.push(n[c++]):l.push([NaN,NaN])}return l}function qt(t){const{cols:e,rows:r,xres:o,yres:s,usePixelCenter:n,inSR:a,outSR:l}=t;let{xmin:i,ymax:c}=t;n&&(i+=o/2,c-=s/2);const p=[],d=[],h=Math.max(e,r);for(let u=0;u<h;u++){const x=i+o*Math.min(e,u),f=c-s*Math.min(r,u),w=W(new _({x,y:f,spatialReference:a}),l);u<=e&&p.push(w.x),u<=r&&d.push(w.y)}const g=[];for(let u=0;u<e;u++)for(let x=0;x<r;x++)g.push([p[u],d[x]]);return g}function I(t,e=!1){let r=t.wkid||t.wkt;if(!r||t.isGeographic)return null;if(r=String(r),U.has(r)){const a=U.get(r);return e?a==null?void 0:a.gcs:a==null?void 0:a.pcs}const o=t.wkid?T.coordsys(t.wkid):T.fromString(t.isGeographic?E.PE_TYPE_GEOGCS:E.PE_TYPE_PROJCS,t.wkt),s=yt(o,G(t,1e-4)),n=yt(o,0,!0);return U.set(r,{pcs:s,gcs:n}),e?n:s}function yt(t,e=0,r=!1){const o=It.generate(t),s=r?t.horizonGcsGenerate():t.horizonPcsGenerate();if(s==null||!s.length)return null;let n=!1,a=s.find(x=>x.getInclusive()===1&&x.getKind()===1);if(!a){if(a=s.find(x=>x.getInclusive()===1&&x.getKind()===0),!a)return null;n=!0}const l=o.isPannableRectangle(),i=a.getCoord();if(n)return{isEnvelope:n,isPannable:l,vertices:i,coef:null,bbox:[i[0][0]-e,i[0][1]-e,i[1][0]+e,i[1][1]+e]};let c=0;const p=[];let[d,h]=i[0],[g,u]=i[0];for(let x=0,f=i.length;x<f;x++){c++,c===f&&(c=0);const[w,m]=i[x],[y,v]=i[c];if(v===m)p.push([w,y,m,v,2]);else{const M=(y-w)/(v-m||1e-4),P=w-M*m;m<v?p.push([M,P,m,v,0]):p.push([M,P,v,m,1])}d=d<w?d:w,h=h<m?h:m,g=g>w?g:w,u=u>m?u:m}return{isEnvelope:!1,isPannable:l,vertices:i,coef:p,bbox:[d,h,g,u]}}function rt(t,e){const r=[],{cols:o,rows:s,xres:n,yres:a,usePixelCenter:l}=t;let{xmin:i,ymax:c}=t;if(l&&(i+=n/2,c-=a/2),!C(e)){for(let g=0;g<o;g++)for(let u=0;u<s;u++)r.push([i+n*g,c-a*u]);return{points:r}}const p=new Uint8Array(o*s);if(e.isEnvelope){const{bbox:[g,u,x,f]}=e;for(let w=0,m=0;w<o;w++){const y=i+n*w,v=e.isPannable||y>=g&&y<=x;for(let M=0;M<s;M++,m++){const P=c-a*M;v&&P>=u&&P<=f&&(r.push([y,P]),p[m]=1)}}return{points:r,mask:p}}const{coef:d}=e,h=[];for(let g=0;g<s;g++){const u=c-a*g,x=[],f=[];for(let m=0;m<d.length;m++){const[y,v,M,P,X]=d[m];if(u===M&&M===P)x.push(y),x.push(v),f.push(2),f.push(2);else if(u>=M&&u<=P){const F=y*u+v;x.push(F),f.push(X)}}let w=x;if(x.length>2){let m=f[0]===2?0:f[0],y=x[0];w=[];for(let v=1;v<f.length;v++)f[v]===2&&v!==f.length-1||(f[v]!==m&&(w.push(m===0?Math.min(y,x[v-1]):Math.max(y,x[v-1])),m=f[v],y=x[v]),v===f.length-1&&w.push(f[v]===0?Math.min(y,x[v]):Math.max(y,x[v])));w.sort((v,M)=>v-M)}else x[0]>x[1]&&(w=[x[1],x[0]]);h.push(w)}for(let g=0,u=0;g<o;g++){const x=i+n*g;for(let f=0;f<s;f++,u++){const w=c-a*f,m=h[f];if(m.length===2)x>=m[0]&&x<=m[1]&&(r.push([x,w]),p[u]=1);else if(m.length>2){let y=!1;for(let v=0;v<m.length;v+=2)if(x>=m[v]&&x<=m[v+1]){y=!0;break}y&&(r.push([x,w]),p[u]=1)}}}return{points:r,mask:p}}function Dt(t,e){const[r,o]=e;for(let s=0;s<t.length;s++){const n=t[s][1];(n<r||n>o)&&(t[s]=[NaN,NaN])}}function Rt(t){const e=O(t[0].spatialReference);if(t.length<2||!C(e))return t[0];let{xmin:r,xmax:o,ymin:s,ymax:n}=t[0];for(let a=1;a<t.length;a++){const l=t[a];o=l.xmax+e*a,s=Math.min(s,l.ymin),n=Math.max(n,l.ymax)}return new H({xmin:r,xmax:o,ymin:s,ymax:n,spatialReference:t[0].spatialReference})}function Kt(t,e,r=null,o=!0){if(t.spatialReference.equals(e))return t;const s=Ht(t),n=O(t.spatialReference,!0),a=O(e);if(s===0||z(n)||z(a))return dt(t,e,r,o);const l=t.clone().normalize();if(l.length===1&&t.xmax<n&&t.xmax-n/2>G(t.spatialReference)){const{xmin:i,xmax:c}=t;for(let p=0;p<=s;p++){const d=p===0?i:-n/2,h=p===s?c-n*p:n/2;l[p]=new H({xmin:d,xmax:h,ymin:t.ymin,ymax:t.ymax,spatialReference:t.spatialReference})}}return Rt(l.map(i=>dt(i,e,r,o)).filter(i=>!!i))}function dt(t,e,r=null,o=!0,s=!0){const n=t.spatialReference;if(n.equals(e))return t;Y(n,e,r);const a=W(t,e,r);if(s&&e.isWebMercator&&a&&(a.ymax=Math.min(20037508342787e-6,a.ymax),a.ymin=Math.max(-20037508342787e-6,a.ymin),a.ymin>=a.ymax))return null;if(!o||!a)return a;const l=D(n,!0),i=D(e,!0);if(z(l)||z(i))return a;const c=G(n,.001),p=G(n,500),d=G(e,.001);if(Math.abs(a.xmin-i[0])<d&&Math.abs(a.xmax-i[1])<d){const h=Math.abs(t.xmin-l[0]),g=Math.abs(l[1]-t.xmax);if(h<c&&g>p){a.xmin=i[0];const u=[];u.push(new _(t.xmax,t.ymin,n)),u.push(new _(t.xmax,(t.ymin+t.ymax)/2,n)),u.push(new _(t.xmax,t.ymax,n));const x=u.map(f=>xt(f,e,r)).filter(f=>!isNaN(f==null?void 0:f.x)).map(f=>f.x);a.xmax=Math.max.apply(null,x)}if(g<c&&h>p){a.xmax=i[1];const u=[];u.push(new _(t.xmin,t.ymin,n)),u.push(new _(t.xmin,(t.ymin+t.ymax)/2,n)),u.push(new _(t.xmin,t.ymax,n));const x=u.map(f=>xt(f,e,r)).filter(f=>!isNaN(f==null?void 0:f.x)).map(f=>f.x);a.xmin=Math.min.apply(null,x)}}else{const h=G(e,.001);Math.abs(a.xmin-i[0])<h&&(a.xmin=i[0]),Math.abs(a.xmax-i[1])<h&&(a.xmax=i[1])}return a}function O(t,e=!1){const r=e?20037508342787e-6:20037508342788905e-9;return t.isWebMercator?2*r:t.wkid&&t.isGeographic?360:2*Bt[t.wkid]||null}function D(t,e=!1){if(t.isGeographic)return[-180,180];const r=O(t,e);return C(r)?[-r/2,r/2]:null}function gt(t,e,r,o){let s=(t-e)/r;return s-Math.floor(s)!=0?s=Math.floor(s):o&&(s-=1),s}function Ht(t,e=!1){const r=O(t.spatialReference);if(!C(r))return 0;const o=e?0:-(r/2),s=G(t.spatialReference),n=!e&&Math.abs(t.xmax-r/2)<s?r/2:t.xmax,a=!e&&Math.abs(t.xmin+r/2)<s?-r/2:t.xmin;return gt(n,o,r,!0)-gt(a,o,r,!1)}function ie(t){const e=t.storageInfo.origin.x,r=O(t.spatialReference,!0);if(!C(r))return{originX:e,halfWorldWidth:null,pyramidsInfo:null};const o=r/2,{nativePixelSize:s,storageInfo:n,extent:a}=t,{maximumPyramidLevel:l,blockWidth:i,pyramidScalingFactor:c}=n;let p=s.x;const d=[],h=C(t.transform)&&t.transform.type==="gcs-shift",g=e+(h?0:o),u=h?r-e:o-e;for(let x=0;x<=l;x++){const f=(a.xmax-e)/p/i,w=f-Math.floor(f)==0?f:Math.ceil(f),m=u/p/i,y=m-Math.floor(m)==0?m:Math.ceil(m),v=Math.floor(g/p/i),M=Math.round(g/p)%i,P=(i-Math.round(u/p)%i)%i;d.push({resolutionX:p,blockWidth:i,datsetColumnCount:w,worldColumnCountFromOrigin:y,leftMargin:M,rightPadding:P,originColumnOffset:v}),p*=c}return{originX:e,halfWorldWidth:o,pyramidsInfo:d,hasGCSSShiftTransform:h}}function Qt(t){if(!t||t.isGeographic)return t;const e=String(t.wkid||t.wkt);let r;return Z.has(e)?r=Z.get(e):(r=(t.wkid?T.coordsys(t.wkid):T.fromString(E.PE_TYPE_PROJCS,t.wkt)).getGeogcs().getCode(),Z.set(e,r)),new Nt({wkid:r})}function ae(t){const e=t.isAdaptive&&t.spacing==null;let r=t.spacing||[L,L],o=tt(t),s={cols:o.size[0]+1,rows:o.size[1]+1};const n=o.outofBoundPointCount>0&&o.outofBoundPointCount<o.offsets.length/2;let a=o.outofBoundPointCount===o.offsets.length/2||e&&n?[0,0]:mt(o.offsets,s,r,V);const l=(a[0]+a[1])/2,i=t.projectedExtent.spatialReference,c=t.srcBufferExtent.spatialReference;if(e&&(n||l>V)&&(Pt(i,c,t.datumTransformation)&&(i.isGeographic||C(I(i))),r=[q,q],o=tt(pt(ut({},t),{spacing:r})),s={cols:o.size[0]+1,rows:o.size[1]+1},a=mt(o.offsets,s,r,V)),o.error=a,r[0]>1&&(o.coefficients=wt(o.offsets,s,n)),t.includeGCSGrid&&!i.isGeographic&&!i.isWebMercator)if(c.isGeographic)o.gcsGrid={offsets:o.offsets,coefficients:o.coefficients,spacing:r};else{const p=I(i);if(C(p)&&!p.isEnvelope){const d=Qt(i),h=Kt(t.projectedExtent,d),{offsets:g}=tt(pt(ut({},t),{srcBufferExtent:h,spacing:r})),u=wt(g,s,n);o.gcsGrid={offsets:g,coefficients:u,spacing:r}}}return o}function tt(t){const{projectedExtent:e,srcBufferExtent:r,pixelSize:o,datumTransformation:s,rasterTransform:n}=t,a=e.spatialReference,l=r.spatialReference;Y(a,l);const{xmin:i,ymin:c,xmax:p,ymax:d}=e,h=O(l),g=C(h)&&(t.hasWrapAround||(n==null?void 0:n.type)==="gcs-shift"),u=t.spacing||[L,L],x=u[0]*o.x,f=u[1]*o.y,w=u[0]===1,m=Math.ceil((p-i)/x-.1/u[0])+(w?0:1),y=Math.ceil((d-c)/f-.1/u[1])+(w?0:1),v=Jt({cols:m,rows:y,xmin:i,ymax:d,xres:x,yres:f,inSR:a,outSR:l,datumTransformation:s,preferPE:u[0]<=q,usePixelCenter:w}),M=[];let P,X=0;const F=w?-1:NaN,{xmin:St,xmax:_t,ymax:bt,width:Et,height:Tt}=r,Gt=G(l,500);for(let A=0;A<m;A++){const Q=[];for(let N=0;N<y;N++){let S=v[A*y+N];if(g&&S[0]>_t&&S[0]>h/2-Gt&&(S[0]-=h),!S||isNaN(S[0])||isNaN(S[1]))M.push(F),M.push(F),Q.push(null),X++;else{if(n){const st=n.inverseTransform(new _({x:S[0],y:S[1],spatialReference:l}));S=[st.x,st.y]}Q.push(S),A>0&&g&&P[N]&&S[0]<P[N][0]&&(S[0]+=h),M.push((S[0]-St)/Et),M.push((bt-S[1])/Tt)}}P=Q}return{offsets:M,error:null,coefficients:null,outofBoundPointCount:X,spacing:u,size:w?[m,y]:[m-1,y-1]}}function wt(t,e,r){const{cols:o,rows:s}=e,n=new Float32Array((o-1)*(s-1)*2*6),a=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),l=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let i=0;i<o-1;i++){for(let c=0;c<s-1;c++){let p=i*s*2+2*c;const d=t[p],h=t[p+1],g=t[p+2],u=t[p+3];p+=2*s;const x=t[p],f=t[p+1],w=t[p+2],m=t[p+3];let y=0,v=12*(c*(o-1)+i);for(let M=0;M<3;M++)n[v++]=a[y++]*d+a[y++]*g+a[y++]*w;y=0;for(let M=0;M<3;M++)n[v++]=a[y++]*h+a[y++]*u+a[y++]*m;y=0;for(let M=0;M<3;M++)n[v++]=l[y++]*d+l[y++]*x+l[y++]*w;y=0;for(let M=0;M<3;M++)n[v++]=l[y++]*h+l[y++]*f+l[y++]*m}if(r)for(let c=0;c<n.length;c++)isNaN(n[c])&&(n[c]=-1)}return n}function le(t){const e=t.clone().normalize();return e.length===1?e[0]:Rt(e)}function fe(t,e,r){const{storageInfo:o,pixelSize:s}=e;let n,a=!1;const{pyramidResolutions:l}=o;if(C(l)&&l.length){const h=(t.x+t.y)/2,g=l[l.length-1],u=(g.x+g.y)/2,x=(s.x+s.y)/2;if(h<=x)n=0;else if(h>=u)n=l.length,a=h/u>8;else{let w,m=x;for(let y=1;y<=l.length;y++){if(w=(l[y-1].x+l[y-1].y)/2,h<=w){h===w?n=y:r==="down"?(n=y-1,a=h/m>8):n=r==="up"||h-m>w-h||h/m>2?y:y-1;break}m=w}}const f=n===0?s:l[n-1];return{pyramidLevel:n,pyramidResolution:new _({x:f.x,y:f.y,spatialReference:e.spatialReference}),excessiveReading:a}}const i=Math.log(t.x/s.x)/Math.LN2,c=Math.log(t.y/s.y)/Math.LN2,p=e.storageInfo.maximumPyramidLevel||0;n=r==="down"?Math.floor(Math.min(i,c)):r==="up"?Math.ceil(Math.max(i,c)):Math.round((i+c)/2),n<0?n=0:n>p&&(a=n>p+3,n=p);const d=2**n;return{pyramidLevel:n,pyramidResolution:new _({x:d*e.nativePixelSize.x,y:d*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:a}}let k=class extends Ot{get affectsPixelSize(){return!1}forwardTransform(t){return t}inverseTransform(t){return t}};R([$()],k.prototype,"affectsPixelSize",null),R([$({json:{write:!0}})],k.prototype,"spatialReference",void 0),k=R([K("esri.layers.support.rasterTransforms.BaseRasterTransform")],k);const ot=k;let j=class extends ot{constructor(){super(...arguments),this.type="gcs-shift",this.tolerance=1e-8}forwardTransform(t){return(t=t.clone()).type==="point"?(t.x>180+this.tolerance&&(t.x-=360),t):(t.xmin>=180-this.tolerance?(t.xmax-=360,t.xmin-=360):t.xmax>180+this.tolerance&&(t.xmin=-180,t.xmax=180),t)}inverseTransform(t){return(t=t.clone()).type==="point"?(t.x<-this.tolerance&&(t.x+=360),t):(t.xmin<-this.tolerance&&(t.xmin+=360,t.xmax+=360),t)}};R([nt({GCSShiftXform:"gcs-shift"})],j.prototype,"type",void 0),R([$()],j.prototype,"tolerance",void 0),j=R([K("esri.layers.support.rasterTransforms.GCSShiftTransform")],j);const Vt=j;let B=class extends ot{constructor(){super(...arguments),this.type="identity"}};R([nt({IdentityXform:"identity"})],B.prototype,"type",void 0),B=R([K("esri.layers.support.rasterTransforms.IdentityTransform")],B);const Ut=B;function et(t,e,r){const{x:o,y:s}=e;if(r<2)return{x:t[0]+o*t[2]+s*t[4],y:t[1]+o*t[3]+s*t[5]};if(r===2){const h=o*o,g=s*s,u=o*s;return{x:t[0]+o*t[2]+s*t[4]+h*t[6]+u*t[8]+g*t[10],y:t[1]+o*t[3]+s*t[5]+h*t[7]+u*t[9]+g*t[11]}}const n=o*o,a=s*s,l=o*s,i=n*o,c=n*s,p=o*a,d=s*a;return{x:t[0]+o*t[2]+s*t[4]+n*t[6]+l*t[8]+a*t[10]+i*t[12]+c*t[14]+p*t[16]+d*t[18],y:t[1]+o*t[3]+s*t[5]+n*t[7]+l*t[9]+a*t[11]+i*t[13]+c*t[15]+p*t[17]+d*t[19]}}function vt(t,e,r){const{xmin:o,ymin:s,xmax:n,ymax:a,spatialReference:l}=e;let i=[];if(r<2)i.push({x:o,y:a}),i.push({x:n,y:a}),i.push({x:o,y:s}),i.push({x:n,y:s});else{let d=10;for(let h=0;h<d;h++)i.push({x:o,y:s+(a-s)*h/(d-1)}),i.push({x:n,y:s+(a-s)*h/(d-1)});d=8;for(let h=1;h<=d;h++)i.push({x:o+(n-o)*h/d,y:s}),i.push({x:o+(n-o)*h/d,y:a})}i=i.map(d=>et(t,d,r));const c=i.map(d=>d.x),p=i.map(d=>d.y);return new H({xmin:Math.min.apply(null,c),xmax:Math.max.apply(null,c),ymin:Math.min.apply(null,p),ymax:Math.max.apply(null,p),spatialReference:l})}function Zt(t){const[e,r,o,s,n,a]=t,l=o*a-n*s,i=n*s-o*a;return[(n*r-e*a)/l,(o*r-e*s)/i,a/l,s/i,-n/l,-o/i]}let b=class extends ot{constructor(){super(...arguments),this.polynomialOrder=1,this.type="polynomial"}readForwardCoefficients(t,e){const{coeffX:r,coeffY:o}=e;if(r==null||!r.length||o==null||!o.length||r.length!==o.length)return null;const s=[];for(let n=0;n<r.length;n++)s.push(r[n]),s.push(o[n]);return s}writeForwardCoefficients(t,e,r){const o=[],s=[];for(let n=0;n<(t==null?void 0:t.length);n++)n%2==0?o.push(t[n]):s.push(t[n]);e.coeffX=o,e.coeffY=s}get inverseCoefficients(){let t=this._get("inverseCoefficients");const e=this._get("forwardCoefficients");return!t&&e&&this.polynomialOrder<2&&(t=Zt(e)),t}set inverseCoefficients(t){this._set("inverseCoefficients",t)}readInverseCoefficients(t,e){const{inverseCoeffX:r,inverseCoeffY:o}=e;if(r==null||!r.length||o==null||!o.length||r.length!==o.length)return null;const s=[];for(let n=0;n<r.length;n++)s.push(r[n]),s.push(o[n]);return s}writeInverseCoefficients(t,e,r){const o=[],s=[];for(let n=0;n<(t==null?void 0:t.length);n++)n%2==0?o.push(t[n]):s.push(t[n]);e.inverseCoeffX=o,e.inverseCoeffY=s}get affectsPixelSize(){return this.polynomialOrder>0}forwardTransform(t){if(t.type==="point"){const e=et(this.forwardCoefficients,t,this.polynomialOrder);return new _({x:e.x,y:e.y,spatialReference:t.spatialReference})}return vt(this.forwardCoefficients,t,this.polynomialOrder)}inverseTransform(t){if(t.type==="point"){const e=et(this.inverseCoefficients,t,this.polynomialOrder);return new _({x:e.x,y:e.y,spatialReference:t.spatialReference})}return vt(this.inverseCoefficients,t,this.polynomialOrder)}};R([$({json:{write:!0}})],b.prototype,"polynomialOrder",void 0),R([$()],b.prototype,"forwardCoefficients",void 0),R([it("forwardCoefficients",["coeffX","coeffY"])],b.prototype,"readForwardCoefficients",null),R([at("forwardCoefficients")],b.prototype,"writeForwardCoefficients",null),R([$({json:{write:!0}})],b.prototype,"inverseCoefficients",null),R([it("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],b.prototype,"readInverseCoefficients",null),R([at("inverseCoefficients")],b.prototype,"writeInverseCoefficients",null),R([$()],b.prototype,"affectsPixelSize",null),R([nt({PolynomialXform:"polynomial"})],b.prototype,"type",void 0),b=R([K("esri.layers.support.rasterTransforms.PolynomialTransform")],b);const te=b,Ct={GCSShiftXform:Vt,IdentityXform:Ut,PolynomialXform:te},ee=Object.keys(Ct);function ce(t){const e=t==null?void 0:t.type;return!t||ee.includes(e)}function ue(t){if(!(t!=null&&t.type))return null;const e=Ct[t==null?void 0:t.type];if(e){const r=new e;return r.read(t),r}return null}export{Kt as B,ae as D,oe as G,ie as K,O as L,se as N,xt as T,le as V,Ht as X,fe as Z,Vt as c,ce as e,ue as f,te as m,Pt as y};
